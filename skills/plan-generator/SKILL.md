---
name: plan-generator
description: 작업 계획 생성 및 관리. 복잡한 기능 구현, 리팩토링, 버그 수정 등 계획이 필요한 작업 요청 시 사용. 서브에이전트로 코드 분석 후 계획 문서를 생성하고 피드백을 거쳐 승인 후 작업 시작.
model: opus
---

# Plan Generator

작업 요청을 분석하여 체계적인 실행 계획을 생성하고, 피드백을 반영하여 승인 후 작업을 시작하는 스킬.

**핵심 원칙:** 충분한 정보 수집 → 계획 문서 작성 → 피드백 반영 → 승인 후 실행

## 계획 생성 프로세스

### 1단계: 요구사항 명확화

작업 요청을 받으면 먼저 유저에게 추가 정보를 확인한다.

**확인 사항:**
- 작업의 구체적인 범위와 목표
- 우선순위 및 제약 조건
- 기존 코드와의 호환성 요구사항
- 테스트 요구사항
- 특별히 고려해야 할 사항

```
AskUserQuestion 도구 사용:
  - 불명확한 요구사항 확인
  - 선호하는 접근 방식 확인
  - 제약 조건 확인
```

**중요:** 코드 탐색 전에 반드시 유저의 의도를 먼저 파악한다.

### 2단계: 코드베이스 분석 (서브에이전트)

요구사항이 명확해지면 서브에이전트를 통해 관련 코드를 수집한다.

**서브에이전트 디스패치:**

```
Task tool (subagent_type: Explore):
  model: opus
  description: "코드베이스 분석: [작업 주제]"
  prompt: |
    다음 작업을 위해 코드베이스를 분석해주세요:

    [작업 설명]

    분석 항목:
    1. 관련 파일 및 디렉토리 구조
    2. 핵심 클래스/함수/모듈
    3. 의존성 관계
    4. 기존 패턴 및 컨벤션
    5. 수정이 필요한 부분
    6. 영향받는 코드 범위
    7. CLAUDE.md의 파일 생성 규칙 (필수 명령어, 허용/금지 사항 등)

    결과를 구조화하여 보고해주세요.
```

**여러 영역 분석 시:** 독립적인 영역은 병렬로 서브에이전트 디스패치

### 3단계: 계획 문서 작성

수집된 정보를 바탕으로 계획 문서를 생성한다.

**파일 위치:** `.claude/plans/[YYYYMMDD]-[작업명].md`

**계획 문서 템플릿:**

```markdown
# [작업 제목]

## 개요
- **목표:** [달성하고자 하는 것]
- **범위:** [포함/제외 범위]
- **예상 영향:** [영향받는 코드/기능]

## 배경
[현재 상황 및 작업이 필요한 이유]

## 분석 결과
### 관련 코드
- [파일:라인] - [설명]

### 의존성
- [의존 관계 설명]

### 제약 조건
- [고려해야 할 제약 사항]

## 작업 계획

### Task 1: [작업명]
- **목표:** [이 작업의 목표]
- **수정 파일:** [파일 목록]
- **파일 생성 방법:** [CLI 명령어 명시 | 직접 생성]
- **상세 내용:**
  1. [세부 단계 1]
  2. [세부 단계 2]
- **검증:** [확인 방법]

### Task 2: [작업명]
...

## 테스트 계획
- [ ] [테스트 항목 1]
- [ ] [테스트 항목 2]

## 롤백 계획
[문제 발생 시 복구 방법]

## 열린 질문
- [ ] [확인이 필요한 사항]
```

### 4단계: 피드백 수집

계획 문서 작성 후 유저에게 리뷰를 요청한다.

**리뷰 요청 메시지:**

```
계획 문서를 작성했습니다: .claude/plans/[파일명].md

검토 후 피드백을 주세요:
- 수정이 필요한 부분
- 추가해야 할 작업
- 우선순위 변경
- 우려되는 점

피드백이 없으면 "승인"이라고 말씀해주세요.
```

**피드백 반영:**
- 유저 피드백에 따라 계획 문서 업데이트
- 변경 사항을 명확히 표시
- 재검토 요청

### 5단계: 승인 및 실행

피드백 반영이 완료되면 최종 승인을 요청한다.

**승인 요청:**

```
AskUserQuestion 도구 사용:
  question: "계획이 확정되었습니다. 작업을 시작할까요?"
  options:
    - label: "승인"
      description: "계획대로 작업을 시작합니다"
    - label: "수정 필요"
      description: "추가 수정 후 다시 검토합니다"
```

**승인 후:**
- 계획 문서 상단에 `status: approved` 추가
- subagent-driven-development 스킬로 작업 실행
- 또는 계획에 따라 직접 구현 시작

## 계획 문서 관리

### 디렉토리 구조

```
.claude/
└── plans/
    ├── 20260131-user-auth-refactor.md
    ├── 20260130-api-optimization.md
    └── ...
```

### 파일명 규칙

`[YYYYMMDD]-[작업명-kebab-case].md`

### 상태 표시

계획 문서 frontmatter에 상태 표시:

```yaml
---
status: draft | review | approved | in-progress | completed
created: 2026-01-31
updated: 2026-01-31
---
```

## 주의사항

**반드시:**
- 코드 탐색 전에 유저 의도 확인
- 서브에이전트로 코드 분석 수행
- 계획 문서는 항상 파일로 생성
- 피드백 사이클 완료 후 승인 요청
- opus 모델로 계획 생성

**금지:**
- 계획 없이 바로 구현 시작
- 유저 확인 없이 가정하여 진행
- 피드백 스킵하고 바로 실행
- 계획 문서 없이 구두로만 진행

## 워크플로우 예시

```
유저: 사용자 인증 로직을 JWT로 리팩토링해줘

Claude: plan-generator 스킬을 사용하여 작업 계획을 생성합니다.

[1단계: 요구사항 확인]
Claude: 몇 가지 확인이 필요합니다.
  - 기존 세션 기반 인증을 완전히 대체할까요?
  - 토큰 만료 시간 정책은?
  - 리프레시 토큰도 구현할까요?

유저: 완전 대체, 1시간, 리프레시 토큰 필요

[2단계: 코드 분석]
Claude: 서브에이전트로 코드베이스를 분석합니다.
  [Explore 에이전트 디스패치]

에이전트: 분석 완료
  - 인증 관련 파일: auth/, middleware/
  - 영향 범위: 15개 엔드포인트
  - 현재 패턴: session-based with Redis

[3단계: 계획 문서 작성]
Claude: .claude/plans/20260131-jwt-auth-refactor.md 생성 완료

[4단계: 피드백]
유저: Task 3과 4 순서를 바꿔줘

Claude: 계획 문서 업데이트 완료

[5단계: 승인]
Claude: 계획을 승인하시겠습니까?

유저: 승인

Claude: subagent-driven-development로 작업을 시작합니다.
```
